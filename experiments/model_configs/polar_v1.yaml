# Polar-V1 Model Configuration
# This configuration implements the full Polar-V1 model with all components

model_type: v1multi

# ConvNet: Polar spatial processing (pyramid + quadrature + polar decompose)
convnet:
  type: polar
  params:
    n_pyramid_levels: 4
    n_pairs: 64
    kernel_size: 15

# Modulator: Polar behavior encoding (gaze encoder + behavior encoder)
modulator:
  type: polar
  params:
    beh_dim: 128
    dt: 0.008333  # 1/120 Hz = 8.33ms
    use_pos_fourier: true
    Kpos: 2
    init_pos_freq_cpx: 0.015625  # 1/64 (using explicit decimal)

# Recurrent: Polar dynamics + temporal summarization
recurrent:
  type: polar
  params:
    dt: 0.008333   # 1/120 Hz = 8.33ms
    lambda_fix: 10.0
    lambda_sac: 40.0
    alpha_fast: 0.74
    alpha_slow: 0.95
    base_freq_cpx: 0.15
    use_behavior: true
    use_jepa: false  # JEPA requires temporal windowing (future work)

# Readout: Multi-level Gaussian readout
readout:
  type: polar
  params:
    n_units: 8
    bias: true
    initial_std: 5.0
    initial_mean_scale: 0.1
    # n_units will be set per dataset

# Output activation - use identity (none) for log-space like learned_res_small_gru
output_activation: none

# Auxiliary loss weights (for future use)
lambda_jepa: 0.5  # Weight for JEPA loss when enabled
