# V1 multidataset model configuration with ResNet convnet and eye position modulation
# This model has shared components (frontend, ResNet, modulator)
# and experiment specific componenets (adapter, readout)
# the MLP behavior modulator is applied to the output of the convnet through a film layer
model_type: v1multi

# Model dimensions
sampling_rate: 240
initial_input_channels: 1 # number of channels in the input data

# Frontend configuration
adapter:
  type: adapter
  params: {grid_size: 51, init_sigma: 2.5, transform: scale}

frontend:
  type: temporal_basis
  params: {num_delta_funcs: 0, num_cosine_funcs: 6,
          history_bins: 32, causal: true, log_spacing: true, peak_range_ms: [5, 60],
          normalize: true, batch_norm: true}

# Convnet configuration - ResNet
convnet:
  type: resnet
  params:
    channels: [64, 128, 256]  # growth_rate repeated num_blocks times
    dim: 3
    checkpointing: true
    block_config:
      conv_params:
        type: depthwise
        kernel_size: [2, 5, 5]
        padding: [0, 0, 0]
      norm_type: rms
      act_type: gelu
      dropout: 0.1
      pool_params:
        type: avg
        kernel_size: [1, 2, 2]  # Pool only in spatial dimensions
        stride: [1, 2, 2]


# Modulator configuration
modulator:
  type: none
  params: {}

# Recurrent configuration
recurrent:
  type: none
  params: {}

# Readout configuration
readout:
  type: gaussianei
  params:
    n_units: 8
    bias: true
    initial_std_ex: 3.0
    initial_std_inh: 9.0
    weight_constraint_fn: relu

output_activation: softplus

baseline:
  enabled: true
  activation: 'relu'
  init_value: 0.01