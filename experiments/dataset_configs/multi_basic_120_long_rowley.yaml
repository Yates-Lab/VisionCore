types: [backimage, gaborium]
session_dir: ./sessions
sessions: [Allen_2022-04-13,  Luke_2025-08-04]
sampling:
  source_rate: 240
  target_rate: 120
keys_lags:
  robs: 0
  stim: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32]
  behavior: 0 # will match the `expose_as` in `transforms`
  dfs: 0

transforms:
  stim:
    source: stim
    ops:
      - pixelnorm: {}
      - unsqueeze: 1
    expose_as: stim
  
  # robs:
  #   source: robs
  #   ops: [{smooth: {type: gaussian, params: 1.0}}]
  #   expose_as: robs
  #   source: robs
  #   ops:
  #     - smooth: 
  #        - type: gaussian
  #        - params: 1.0
  #   expose_as: robs
  eye_vel:
    source: eyepos          # raw key in DictDataset
    ops:                    # ordered transform list
      - diff: {axis: 0} # finite-difference velocity
      # - mul: 240            # Hz → deg s⁻¹
      - maxnorm: {}
      - symlog: {}
      - temporal_basis:     # acausal raised-cosine embedding
          num_delta_funcs: 0
          num_cosine_funcs: 10
          history_bins: 50
          causal: false
          log_spacing: false
          peak_range_ms: [30, 200]
          normalize: true
      - splitrelu:
          split_dim: 1
          trainable_gain: false
    expose_as: behavior 
    concatenate: true 
  
  eye_pos:
    source: eyepos
    ops: []  # No processing, just pass through
    expose_as: behavior
    concatenate: true    # place in batch["behavior"]

datafilters:
  dfs:
    ops: [{valid_nlags: {n_lags: 32}}, {missing_pct: {threshold: 45}}]
    expose_as: dfs
    
train_val_split: 0.8
seed: 1002



